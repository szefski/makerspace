  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10 col-xl-8">
{{with .Data.member_approved}}
        <p class="alert alert-success">
          <a href="/member/{{.Id}}">@{{.Username}}</a>'s membership approved.
        </p>
{{end}}
{{with .Get_all_pending_subscriptions}}
        <h4>
          <a href="#pending-subscriptions" data-toggle="collapse" aria-expanded="true" class="dropdown-chevron"></a>
          Pending Subscription Requests
        </h4>
        <form action="/admin" method="post" class="collapse show mx-sm-3" id="pending-subscriptions">
          <table class="table table-sm table-striped table-responsive text-nowrap">
            <thead>
              <tr>
                <th>Username</th>
                <th class="w-100">Name</th>
                <th>Type</th>
                <th>Request date</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
  {{range .}}
              <tr>
                <td><a href="/member/{{.Member.Id}}">@{{.Username}}</a></td>
                <td>{{.Member.Name}}</td>
                <td>{{with index $.Plans .Plan_id}}{{.Name}}{{end}}</td>
                <td>{{.Requested_at.Format "2006-01-02"}}</td>
                <td>
                  <button type="submit" name="approve-membership" value="{{.Id}}" class="btn btn-sm btn-primary">Approve</button>
                  <button type="submit" name="decline-membership" value="{{.Id}}" class="btn btn-sm btn-danger">Decline</button>
                </td>
              </tr>
  {{end}}
{{end}}
            </tbody>
          </table>
        </form>
        <h4>
{{if .PostFormValue "member-upload"}}
          <a href="#upload-members" data-toggle="collapse" aria-expanded="true" class="dropdown-chevron"></a>
{{else}}
          <a href="#upload-members" data-toggle="collapse" aria-expanded="false" class="dropdown-chevron collapsed"></a>
{{end}}
          Upload Members
        </h4>
        <form action="/admin" method="post" id="upload-members" class="{{if not (.PostFormValue "member-upload")}}collapse {{end}}mx-sm-3">
          <strong>CSV Format:</strong>
          <p class="ml-3 small">
            Username, Name, E-mail <span class="text-muted">{, Registration date = [YYYY-MM-DD], Card # = [XX:XXXXX], [free]}</span>
          </p>
          <p class="alert alert-info mt-1">
            The fields in braces are optional. Each new user must be input on a separate line.<br>
            <strong>Example:</strong><br>
              <small class="ml-3">
                jsmith01, John Smith, j.smith@gmail.com, 00:00000, free
              </small>
              <br>
            The above example creates a new user, jsmith01, who is immediately approved as a free account.  Each new user is sent an automatic password-reset e-mail.
          </p>
          <textarea name="member-upload" class="form-group form-control" rows="5">
{{- range .Data.lines}}
{{if .}}{{.}}{{end -}}
{{end -}}
          </textarea>
          <button type="submit" class="btn btn-primary mb-2">Submit</button>
{{range $i, $e := .Data.line_error}}
  {{with $e}}
          <p class="alert alert-danger">
            <strong>Line {{add 1 $i}}:</strong>
    {{range .}}
            <br><span class="ml-2">{{.}}.</span>
    {{end}}
          </p>
  {{end}}
{{end}}
{{range $i, $m := .Data.line_success}}
  {{with $m}}
          <p class="alert alert-success">
            <strong>Line {{add 1 $i}}:</strong>
            <a href="/member/{{.Id}}">@{{.Username}}</a> created.
          </p>
  {{end}}
{{end}}
        </form>
      </div>
    </div>
  </div>
